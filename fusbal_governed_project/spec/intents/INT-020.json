{
  "intent_id": "INT-020",
  "title": "Calibration + BEV mapping MVP",
  "status": "closed",
  "created_date": "2026-01-20",
  "runbooks": {
    "decision": "update",
    "paths_mdt": [
      "spec/md/docs/runbooks/calibration-and-bev.mdt"
    ],
    "notes": "This intent introduces calibration input records, pitch templates, auto-fit diagnostics, and trust-first BEV gating. A runbook is required so future LLMs/humans can navigate and reproduce calibration workflows safely."
  },
  "paths_allowed": [
    "spec/",
    "spec/md/docs/",
    "pipeline/",
    "status/audit/"
  ],
  "paths_excluded": [
    "docs/",
    "status/intents/",
    "status/portal/",
    "status/wizard/"
  ],
  "close_gate": [
    "npm run guardrails",
    "npm run generate",
    "npm run audit:intent -- --intent-id INT-020"
  ],
  "summary": [
    "Implement pitch mapping robust to imperfect/partial markings; V1 assumes frames are pre-undistorted (`image_pre_undistorted=true`) and MUST fail explicitly with diagnostics when that assumption is violated.",
    "Gate BEV outputs on calibration quality; always still deliver overlay/video diagnostics."
  ],
  "non_goals": [
    "Build a full interactive calibration UI (V1 uses minimal input formats and diagnostics).",
    "Guarantee calibration success for every venue; prefer explicit failure with diagnostics.",
    "Support raw distorted (wide-angle) frames in V1 (deferred; see REQ-CAL-UNDISTORT-001)."
  ],
  "success_criteria": [
    "Pitch templates + calibration input records are explicit, versioned, and stored as JSON files under a stable per-venue/pitch layout (no ad-hoc CLI args).",
    "Auto-fit emits a calibration result with explicit success/failure semantics plus diagnostics including RMS reprojection error (px), inlier ratio, and counts.",
    "Manual fallback and calibration quality gating use deterministic thresholds: BEV is allowed only when `rms_reprojection_error_px <= 4.0`, `inlier_ratio >= 0.60`, `num_inliers >= 12`, and `marking_coverage_score_0_to_1 >= 0.50`; BEV artifacts are suppressed on fail with explicit reasons and recorded diagnostics."
  ],
  "requirements_in_scope": [
    "FUSBAL-V1-CAL-001",
    "FUSBAL-V1-BEV-001",
    "FUSBAL-V1-TRUST-001"
  ],
  "task_ids_planned": [
    "TASK-CAL-001",
    "TASK-CAL-002",
    "TASK-CAL-003"
  ],
  "quality_areas": [
    {
      "area_id": "functional",
      "title": "Functional objectives",
      "task_ids": [
        "TASK-CAL-001",
        "TASK-CAL-002"
      ],
      "objectives": [
        "Pitch templates + calibration input schemas are explicit and versioned.",
        "Auto-fit emits reprojection error diagnostics and explicit failure semantics."
      ]
    },
    {
      "area_id": "nonfunctional",
      "title": "Non-functional objectives",
      "categories_required": [
        "correctness_safety",
        "performance",
        "security",
        "maintainability"
      ],
      "task_ids": [
        "TASK-CAL-003"
      ],
      "objectives": [
        "Quality gating suppresses BEV output on low confidence with clear reasons (correctness/safety).",
        "Inputs/outputs are deterministic and validation errors are actionable."
      ]
    }
  ],
  "work_packages": [
    {
      "work_package_id": "INT-020-001",
      "title": "Pitch model + mapping",
      "items": [
        "TASK-CAL-001 Pitch templates + calibration input schema (multi-venue/pitch) + contract update.",
        "TASK-CAL-002 Auto-fit from field markings + reprojection diagnostics + contract update."
      ]
    },
    {
      "work_package_id": "INT-020-002",
      "title": "Manual fallback + quality gates",
      "items": [
        "TASK-CAL-003 Manual correspondence fallback input + explicit calibration quality gating + contract update."
      ]
    }
  ],
  "closed_date": "2026-01-21"
}
