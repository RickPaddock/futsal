{
  "schema_version": 1,
  "type": "requirements_area",
  "area": "v1",
  "requirements": [
    {
      "id": "REQ-V1-VIDEO-INGEST-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Video ingest: given a local single-camera match video, the pipeline can decode frames deterministically and produce a time-indexed stream for downstream detectors/trackers.",
      "acceptance": [
        "A CLI command accepts a local video path and emits a deterministic frame/timestamp sequence (frame_index + t_ms).",
        "Failure modes are explicit and actionable (missing file, unsupported codec, decode failure).",
        "No machine-specific absolute paths are written into manifests or outputs; paths are portable/provenance-only."
      ],
      "owner": "platform",
      "tags": [
        "v1",
        "video",
        "ingest"
      ]
    },
    {
      "id": "REQ-V1-VIDEO-RUNNER-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "End-to-end runner: ingest a video and export a valid V1 output bundle with tracks/events under `output/<match_id>/` (plumbing-first, deterministic).",
      "acceptance": [
        "A CLI command runs end-to-end from a local video to a bundle directory containing at minimum `manifest.json`, `tracks.jsonl`, `events.json`, `report.json`, and required diagnostics placeholders.",
        "Tracks/events conform to the contract validators and can be validated via `validate` without manual edits.",
        "The runner is trust-first: when detections are unavailable or uncertain, it emits explicit missing/unknown state and does not fabricate positions/events."
      ],
      "owner": "platform",
      "tags": [
        "v1",
        "runner",
        "outputs"
      ]
    },
    {
      "id": "REQ-V1-BALL-DETECT-BASELINE-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Baseline real ball detections: given a provided futsal video, the pipeline can emit non-empty ball detections/tracks on at least a subset of frames with confidence and diagnostics.",
      "acceptance": [
        "A baseline ball detector runs locally (no network) and emits per-frame ball detection candidates with confidence in [0,1].",
        "Detector has explicit failure/missing behavior and can be disabled; downstream tracking remains valid and schema-stable.",
        "At least one deterministic UAT clip produces ball track points with `pos_state=present` on some frames and explicit missing elsewhere (no hallucination)."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "ball",
        "detections"
      ]
    },
    {
      "id": "FUSBAL-V1-TRUST-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Trust-first behavior: avoid identity swaps and ball/event hallucinations; prefer Unknown/missing over wrong.",
      "acceptance": [
        "Player tracking prefers track breaks over ID swaps when ambiguous.",
        "Ball tracking explicitly supports missing/unknown state and does not fabricate positions.",
        "Event inference is high-precision (low-recall acceptable) and emits confidence with evidence links."
      ],
      "owner": "product",
      "tags": [
        "v1",
        "trust"
      ]
    },
    {
      "id": "FUSBAL-V1-OUT-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Produce a deterministic per-match output bundle (overlay, BEV, tracks, events, report) with diagnostics.",
      "acceptance": [
        "A match run outputs a stable directory layout under `output/<match_id>/`.",
        "At minimum, an overlay video and a report describing confidence/known gaps are produced.",
        "BEV outputs are produced only when calibration quality passes thresholds; otherwise disabled with reasons."
      ],
      "owner": "platform",
      "tags": [
        "v1",
        "outputs"
      ]
    },
    {
      "id": "FUSBAL-V1-DATA-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "All sources emit a canonical track record format suitable for fusion and reporting.",
      "acceptance": [
        "Tracks are stored as `.jsonl` (one record per entity per sample) plus JSON metadata.",
        "Each sample includes timestamp, coordinate frame, uncertainty, and optional quality (0–1)."
      ],
      "owner": "platform",
      "tags": [
        "v1",
        "data"
      ]
    },
    {
      "id": "FUSBAL-V1-CAL-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Calibration maps each camera to pitch coordinates with explicit quality gating and diagnostics.",
      "acceptance": [
        "Calibration outputs homographies (or equivalent) and a quality score with failure reasons.",
        "If auto-calibration fails, a minimal manual fallback can produce a reusable calibration artifact."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "calibration"
      ]
    },
    {
      "id": "FUSBAL-V1-BEV-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "When calibration quality is sufficient, generate bird’s-eye-view (BEV) tracks and video in pitch meters.",
      "acceptance": [
        "Players (and ball when available) are projected into a consistent pitch coordinate system in meters.",
        "BEV video renders movement with clear confidence cues and missing-state semantics."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "bev"
      ]
    },
    {
      "id": "REQ-CAL-UNDISTORT-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Deferred: support raw distorted (wide-angle) frames via explicit undistortion inputs and calibration workflow.",
      "acceptance": [
        "The calibration workflow supports `image_pre_undistorted=false` with an explicit lens distortion model and parameters (versioned and validated).",
        "Undistortion is applied deterministically before calibration fitting, with diagnostics that record the model and parameters used.",
        "This requirement is deferred (not required for INT-020 / V1 calibration MVP scope)."
      ],
      "owner": "vision",
      "tags": [
        "deferred",
        "calibration",
        "distortion"
      ]
    },
    {
      "id": "FUSBAL-V1-PLAYER-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Detect and track all players per match with conservative identity continuity.",
      "acceptance": [
        "Per-frame detections carry confidence and are filtered to the pitch area when possible.",
        "Tracking produces track IDs and per-track confidence; ambiguous associations cause breaks, not swaps."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "players"
      ]
    },
    {
      "id": "FUSBAL-V1-TEAM-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Assign players to Team A/B via bib colors (plus smoothing) with an Unknown state.",
      "acceptance": [
        "Team label is output per player sample (A/B/Unknown) with confidence.",
        "Assignments are temporally smoothed and include diagnostics for ambiguous segments."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "teams"
      ]
    },
    {
      "id": "FUSBAL-V1-BALL-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Track the ball when visible and explicitly represent missing/unknown spans without hallucination.",
      "acceptance": [
        "Ball detector/track output includes confidence and missing-state semantics.",
        "Long ball-missing spans are allowed; output must prefer unknown over wrong."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "ball"
      ]
    },
    {
      "id": "FUSBAL-V1-EVENT-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Infer shots and goals conservatively in V1 (high precision) and emit confidence + evidence pointers.",
      "acceptance": [
        "Events are emitted with timestamps and confidence; uncertain events are omitted or marked candidate.",
        "Goal events include a best-effort evidence window reference (time range / frame ids)."
      ],
      "owner": "vision",
      "tags": [
        "v1",
        "events"
      ]
    },
    {
      "id": "FUSBAL-V1-SENSOR-001",
      "status": "canonical",
      "tracking": {
        "implementation": "todo"
      },
      "guardrails": [
        "guardrails:req_tag_enforced_on_done"
      ],
      "title": "Sensors are optional inputs that only improve outputs when healthy; camera-only output remains sellable.",
      "acceptance": [
        "The pipeline accepts sensor logs as additive TrackSources using the canonical track format.",
        "If sensor ingestion fails or is low quality, outputs fall back to camera-only without contract changes."
      ],
      "owner": "platform",
      "tags": [
        "v1",
        "sensors"
      ]
    }
  ]
}
